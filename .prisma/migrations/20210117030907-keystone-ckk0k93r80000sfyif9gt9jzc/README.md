# Migration `20210117030907-keystone-ckk0k93r80000sfyif9gt9jzc`

This migration has been generated by Taziva at 1/17/2021, 3:09:07 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Post" (
"id" SERIAL,
    "title" TEXT,
    "state" TEXT,
    "image" JSONB,
    "summary" TEXT,
    "publishedAt_utc" TIMESTAMP(3),
    "publishedAt_offset" TEXT,
    "updatedAt_utc" TIMESTAMP(3),
    "updatedAt_offset" TEXT,
    "slug" TEXT,
    "author" INTEGER,

    PRIMARY KEY ("id")
)

CREATE TABLE "KS__ContentType_Post_content" (
"id" SERIAL,
    "document" TEXT,
    "from" INTEGER,

    PRIMARY KEY ("id")
)

CREATE TABLE "PostCategory" (
"id" SERIAL,
    "name" TEXT,
    "slug" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "_Post_categories_many" (
    "A" INTEGER NOT NULL,
    "B" INTEGER NOT NULL
)

CREATE UNIQUE INDEX "Post.slug_unique" ON "Post"("slug")

CREATE UNIQUE INDEX "KS__ContentType_Post_content_from_unique" ON "KS__ContentType_Post_content"("from")

CREATE UNIQUE INDEX "PostCategory.slug_unique" ON "PostCategory"("slug")

CREATE UNIQUE INDEX "_Post_categories_many_AB_unique" ON "_Post_categories_many"("A", "B")

CREATE INDEX "_Post_categories_many_B_index" ON "_Post_categories_many"("B")

ALTER TABLE "Post" ADD FOREIGN KEY("author")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "KS__ContentType_Post_content" ADD FOREIGN KEY("from")REFERENCES "Post"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "_Post_categories_many" ADD FOREIGN KEY("A")REFERENCES "Post"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "_Post_categories_many" ADD FOREIGN KEY("B")REFERENCES "PostCategory"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210117030842-keystone-ckk0k8knc0000rbyi3ntk5an4..20210117030907-keystone-ckk0k93r80000sfyif9gt9jzc
--- datamodel.dml
+++ datamodel.dml
@@ -1,6 +1,6 @@
 datasource postgresql {
-  url = "***"
+  url = "***"
   provider = "postgresql"
 }
 generator client {
@@ -13,5 +13,37 @@
   name     String?
   email    String?  @unique
   isAdmin  Boolean?
   password String?
+  Post     Post[]   @relation("Postauthor")
+}
+
+model Post {
+  id                 Int                           @id @default(autoincrement())
+  title              String?
+  state              String?
+  image              Json?
+  summary            String?
+  publishedAt_utc    DateTime?
+  publishedAt_offset String?
+  updatedAt_utc      DateTime?
+  updatedAt_offset   String?
+  slug               String?                       @unique
+  content            KS__ContentType_Post_content? @relation("KS__ContentType_Post_contentfrom")
+  author             User?                         @relation("Postauthor", fields: [authorId], references: [id])
+  authorId           Int?                          @map("author")
+  categories         PostCategory[]                @relation("Post_categories_many", references: [id])
+}
+
+model KS__ContentType_Post_content {
+  id       Int     @id @default(autoincrement())
+  document String?
+  from     Post?   @relation("KS__ContentType_Post_contentfrom", fields: [fromId], references: [id])
+  fromId   Int?    @map("from")
+}
+
+model PostCategory {
+  id              Int     @id @default(autoincrement())
+  name            String?
+  slug            String? @unique
+  from_categories Post[]  @relation("Post_categories_many", references: [id])
 }
```


