# Migration `20210117035717-keystone-ckk0lz27j0000j5yia4slhp0y`

This migration has been generated by Taziva at 1/17/2021, 3:57:17 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
"id" SERIAL,
    "name" TEXT,
    "email" TEXT,
    "isAdmin" BOOLEAN,
    "password" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "Post" (
"id" SERIAL,
    "title" TEXT,
    "state" TEXT,
    "image" JSONB,
    "summary" TEXT,
    "publishedAt_utc" TIMESTAMP(3),
    "publishedAt_offset" TEXT,
    "slug" TEXT,
    "updatedAt_utc" TIMESTAMP(3),
    "updatedAt_offset" TEXT,
    "createdAt_utc" TIMESTAMP(3),
    "createdAt_offset" TEXT,
    "author" INTEGER,

    PRIMARY KEY ("id")
)

CREATE TABLE "KS__ContentType_Post_content" (
"id" SERIAL,
    "document" TEXT,
    "from" INTEGER,

    PRIMARY KEY ("id")
)

CREATE TABLE "PostCategory" (
"id" SERIAL,
    "name" TEXT,
    "slug" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "_Post_categories_many" (
    "A" INTEGER NOT NULL,
    "B" INTEGER NOT NULL
)

CREATE UNIQUE INDEX "User.email_unique" ON "User"("email")

CREATE UNIQUE INDEX "Post.slug_unique" ON "Post"("slug")

CREATE UNIQUE INDEX "KS__ContentType_Post_content_from_unique" ON "KS__ContentType_Post_content"("from")

CREATE UNIQUE INDEX "PostCategory.slug_unique" ON "PostCategory"("slug")

CREATE UNIQUE INDEX "_Post_categories_many_AB_unique" ON "_Post_categories_many"("A", "B")

CREATE INDEX "_Post_categories_many_B_index" ON "_Post_categories_many"("B")

ALTER TABLE "Post" ADD FOREIGN KEY("author")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "KS__ContentType_Post_content" ADD FOREIGN KEY("from")REFERENCES "Post"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "_Post_categories_many" ADD FOREIGN KEY("A")REFERENCES "Post"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "_Post_categories_many" ADD FOREIGN KEY("B")REFERENCES "PostCategory"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210117035413-keystone-ckk0lv41c0000gwyi3909eq7b..20210117035717-keystone-ckk0lz27j0000j5yia4slhp0y
--- datamodel.dml
+++ datamodel.dml
@@ -1,6 +1,6 @@
 datasource postgresql {
-  url = "***"
+  url = "***"
   provider = "postgresql"
 }
 generator client {
@@ -13,8 +13,9 @@
   name     String?
   email    String?  @unique
   isAdmin  Boolean?
   password String?
+  Post     Post[]   @relation("Postauthor")
 }
 model Post {
   id                 Int                           @id @default(autoincrement())
@@ -29,8 +30,10 @@
   updatedAt_offset   String?
   createdAt_utc      DateTime?
   createdAt_offset   String?
   content            KS__ContentType_Post_content? @relation("KS__ContentType_Post_contentfrom")
+  author             User?                         @relation("Postauthor", fields: [authorId], references: [id])
+  authorId           Int?                          @map("author")
   categories         PostCategory[]                @relation("Post_categories_many", references: [id])
 }
 model KS__ContentType_Post_content {
```


