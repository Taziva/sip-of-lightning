# Migration `20210117161125-keystone-ckk1c75hw0000r2yi6d6c8jvj`

This migration has been generated by Taziva at 1/17/2021, 4:11:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
"id" SERIAL,
    "name" TEXT,
    "email" TEXT,
    "isAdmin" BOOLEAN,
    "password" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "Post" (
"id" SERIAL,
    "title" TEXT,
    "state" TEXT,
    "image" JSONB,
    "content" TEXT,
    "summary" TEXT,
    "publishedAt_utc" TIMESTAMP(3),
    "publishedAt_offset" TEXT,
    "slug" TEXT,
    "updatedAt_utc" TIMESTAMP(3),
    "updatedAt_offset" TEXT,
    "createdAt_utc" TIMESTAMP(3),
    "createdAt_offset" TEXT,
    "author" INTEGER,

    PRIMARY KEY ("id")
)

CREATE TABLE "PostCategory" (
"id" SERIAL,
    "name" TEXT,
    "slug" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "WeeklyDonut" (
"id" SERIAL,
    "title" TEXT,
    "state" TEXT,
    "publishedAt_utc" TIMESTAMP(3),
    "publishedAt_offset" TEXT,
    "image" JSONB,
    "updatedAt_utc" TIMESTAMP(3),
    "updatedAt_offset" TEXT,
    "createdAt_utc" TIMESTAMP(3),
    "createdAt_offset" TEXT,
    "spotifyPlaylist" INTEGER,

    PRIMARY KEY ("id")
)

CREATE TABLE "SpotifyPlaylist" (
"id" SERIAL,
    "uri" TEXT,
    "uid" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "_Post_categories_many" (
    "A" INTEGER NOT NULL,
    "B" INTEGER NOT NULL
)

CREATE UNIQUE INDEX "User.email_unique" ON "User"("email")

CREATE UNIQUE INDEX "Post.slug_unique" ON "Post"("slug")

CREATE UNIQUE INDEX "PostCategory.slug_unique" ON "PostCategory"("slug")

CREATE UNIQUE INDEX "_Post_categories_many_AB_unique" ON "_Post_categories_many"("A", "B")

CREATE INDEX "_Post_categories_many_B_index" ON "_Post_categories_many"("B")

ALTER TABLE "Post" ADD FOREIGN KEY("author")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "WeeklyDonut" ADD FOREIGN KEY("spotifyPlaylist")REFERENCES "SpotifyPlaylist"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "_Post_categories_many" ADD FOREIGN KEY("A")REFERENCES "Post"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "_Post_categories_many" ADD FOREIGN KEY("B")REFERENCES "PostCategory"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210117043911-keystone-ckk0ngxyn000007yi2wolgdw3..20210117161125-keystone-ckk1c75hw0000r2yi6d6c8jvj
--- datamodel.dml
+++ datamodel.dml
@@ -1,6 +1,6 @@
 datasource postgresql {
-  url = "***"
+  url = "***"
   provider = "postgresql"
 }
 generator client {
@@ -40,5 +40,27 @@
   id              Int     @id @default(autoincrement())
   name            String?
   slug            String? @unique
   from_categories Post[]  @relation("Post_categories_many", references: [id])
+}
+
+model WeeklyDonut {
+  id                 Int              @id @default(autoincrement())
+  title              String?
+  state              String?
+  publishedAt_utc    DateTime?
+  publishedAt_offset String?
+  image              Json?
+  updatedAt_utc      DateTime?
+  updatedAt_offset   String?
+  createdAt_utc      DateTime?
+  createdAt_offset   String?
+  spotifyPlaylist    SpotifyPlaylist? @relation("WeeklyDonutspotifyPlaylist", fields: [spotifyPlaylistId], references: [id])
+  spotifyPlaylistId  Int?             @map("spotifyPlaylist")
+}
+
+model SpotifyPlaylist {
+  id          Int           @id @default(autoincrement())
+  uri         String?
+  uid         String?
+  WeeklyDonut WeeklyDonut[] @relation("WeeklyDonutspotifyPlaylist")
 }
```


